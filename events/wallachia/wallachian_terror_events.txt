namespace = wallachian_terror_events
#Initial capital fall event - impaler country
country_event = {
	id = wallachian_terror_events.0
	title = wallachian_terror_events.0.t
	desc = wallachian_terror_events.0.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_attempt_to_capture
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		#effect
		custom_tooltip = wallachian_terror_events_impaled_will_try_to_escape_tooltip
		event_target:impaled_country = {
			country_event = {
				id = wallachian_terror_events.1
				days = 1
			}
		}
	}
	option = {
		name = wallachian_terror_events_dont_capture
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		#effect
		event_target:impaled_country = {
			capital_scope = {
				add_province_modifier = {
					name = wallachian_terror_severed_command
					duration = -1
				}
			}
		}
		custom_tooltip = wallachian_terror_events_capital_penalty_mechanics_tooltip
	}
	option = {
		#If ruler has Impaler personality, this is the only option lol
		name = wallachian_terror_events_impaler_we_must_capture
		trigger = {
			ruler_has_personality = impaler_personality
		}
		highlight = yes
		#effect
		custom_tooltip = wallachian_terror_events_impaled_will_try_to_escape_tooltip
		event_target:impaled_country = {
			country_event = {
				id = wallachian_terror_events.1
				days = 1
			}
		}
	}
}

#Capital captured - Impaled Country
country_event = {
	id = wallachian_terror_events.1
	title = wallachian_terror_events.1.t
	desc = wallachian_terror_events.1.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_run_away
		ai_chance = {
			factor = 10
		}
		if = {
			limit = {
				event_target:impaler_country = {
					full_idea_group = spy_ideas
				}
			}
			#Capture
			event_target:impaler_country = {
				country_event = {
					id = wallachian_terror_events.2
				}
			}
		}
		else = {
			random_list = {
				10 = {
					modifier = {
						OR = {
							ruler_has_personality = calm_personality
							ruler_has_personality = careful_personality
						}
						factor = 1.5
					}
					modifier = {
						ruler_has_personality = tactical_genius_personality
						factor = 3
					}
					#Escape
					hidden_effect = {
						event_target:impaler_country = {
							country_event = {
								id = wallachian_terror_events.3
								days = 1
							}
						}
					}
					country_event = {
						id = wallachian_terror_events.4
					}
				}
				90 = {
					#Capture
					event_target:impaler_country = {
						country_event = {
							id = wallachian_terror_events.2
						}
					}
					modifier = {
						OR = {
							ruler_has_personality = loose_lips_personality
							ruler_has_personality = babbling_buffoon_personality
							ruler_has_personality = naive_personality
						}
						factor = 1.1
					}
				}
			}
		}
	}
	option = {
		name = wallachian_terror_events_go_down_fighting
		ai_chance = {
			factor = 0
		}
		trigger = {
			NOT = {
				ruler_has_personality = craven_personality
			}
		}
		random_list = {
			70 = {
				#die fighting
				country_event = {
					id = wallachian_terror_events.5
				}
			}
			30 = {
				#Capture
				event_target:impaler_country = {
					country_event = {
						id = wallachian_terror_events.2
					}
				}
			}
		}
	}
	option = {
		name = wallachian_terror_events_secret_passage
		highlight = yes
		trigger = {
			ruler_has_personality = secretive_personality
		}
		#100% escape
		hidden_effect = {
			event_target:impaler_country = {
				country_event = {
					id = wallachian_terror_events.3
					days = 1
				}
			}
		}
		country_event = {
			id = wallachian_terror_events.6
		}
		ai_chance = {
			factor = 10000
		}
	}
}

#Captured - Impaler Event - Wallachia
country_event = {
	id = wallachian_terror_events.2
	title = wallachian_terror_events.2.t
	desc = wallachian_terror_events.2.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_impale
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		wallachian_terror_impalement_effect = yes
	}
	option = {
		name = wallachian_terror_events_humiliate
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		if = {
			limit = {
				event_target:impaled_country = {
					is_rival = PREV
				}
			}
			custom_tooltip = wallachian_terror_events_humiliated_rival_prestige_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_rival_to_prestige_or_monarch_power = yes
			}
			custom_tooltip = wallachian_terror_events_humiliated_legitimacy_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_rival_to_legitimacy_or_equivalent = yes
			}
			custom_tooltip = wallachian_terror_events_humiliated_rival_terror_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_rival_to_terror = yes
			}
			add_humiliation_reward = yes
		}
		else = {
			custom_tooltip = wallachian_terror_events_humiliated_ruler_prestige_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_ruler_to_prestige_or_monarch_power = yes
			}
			custom_tooltip = wallachian_terror_events_humiliated_legitimacy_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_ruler_to_legitimacy_or_equivalent = yes
			}
			custom_tooltip = wallachian_terror_events_humiliated_ruler_terror_tooltip
			hidden_effect = {
				wallachian_terror_convert_humiliated_ruler_to_terror = yes
			}
		}
		hidden_effect = {
			event_target:impaled_country = {
				country_event = {
					id = wallachian_terror_events.8
				}
			}
		}
	}
	option = {
		name = wallachian_terror_events_impale_impaler_personality
		trigger = {
			ruler_has_personality = impaler_personality
		}
		highlight = yes
		wallachian_terror_impalement_effect = yes
	}
}

#Escaped - Impaler Event
country_event = {
	id = wallachian_terror_events.3
	title = wallachian_terror_events.3.t
	desc = wallachian_terror_events.3.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_they_escaped
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		add_prestige = -10
		change_terror = {
			value = -2
			scaled_with_gain_modifier = no
		}
	}
	option = {
		name = wallachian_terror_events_they_escaped_impaler
		highlight = yes
		trigger = {
			ruler_has_personality = impaler_personality
		}
		add_prestige = -10
		add_manpower = -2
		add_country_modifier = {
			name = wallachian_terror_senseless_killing_of_our_men
			duration = 1825
		}
		custom_tooltip = wallachian_terror_events_they_escaped_impaler_courtier_death_tooltip
		add_manpower = -0.001
		add_country_modifier = {
			name = wallachian_terror_advisors_avoid_us
			duration = 1825
		}
		change_terror = {
			value = 2
			scaled_with_gain_modifier = yes
		}
	}
}

#Escaped - Impaled Event
country_event = {
	id = wallachian_terror_events.4
	title = wallachian_terror_events.4.t
	desc = wallachian_terror_events.4.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_impaled_escaped
		add_prestige = 10
		capital_scope = {
			add_province_modifier = {
				name = wallachian_terror_leadership_in_exile
				duration = -1
			}
		}
		custom_tooltip = wallachian_terror_events_capital_penalty_mechanics_tooltip
	}
}

#Fight to the death - Impaled Event
country_event = {
	id = wallachian_terror_events.5
	title = wallachian_terror_events.5.t
	desc = wallachian_terror_events.5.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_fight_to_the_death_option
		kill_heir = {
			allow_new_heir = no
		}
		kill_consort = yes
		kill_ruler = yes
		add_stability = -1
		add_war_exhaustion = 3
		add_prestige = 15
		hidden_effect = {
			event_target:impaler_country = {
				country_event = {
					id = wallachian_terror_events.51
				}
			}
		}
	}
}

#Fight to the death - Impaled Event
country_event = {
	id = wallachian_terror_events.51
	title = wallachian_terror_events.51.t
	desc = wallachian_terror_events.51.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_fight_to_the_death_impaler_option
		add_prestige = 5
		change_terror = {
			value = 2
			scaled_with_gain_modifier = no
		}
	}
}

#Escaped - Impaled Event Secret Passage
country_event = {
	id = wallachian_terror_events.6
	title = wallachian_terror_events.6.t
	desc = wallachian_terror_events.6.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_impaled_escaped_secret_passage
		add_adm_power = 20
		add_dip_power = 20
		add_mil_power = 20
		add_prestige = 5
		capital_scope = {
			add_province_modifier = {
				name = wallachian_terror_leadership_in_exile
				duration = -1
			}
		}
		custom_tooltip = wallachian_terror_events_capital_penalty_mechanics_tooltip
	}
}

#Impaled event for impaled country
country_event = {
	id = wallachian_terror_events.7
	title = wallachian_terror_events.7.t
	desc = wallachian_terror_events.7.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_impaled_country_impaled
		add_prestige = -20
		add_legitimacy_equivalent = {
			amount = -50
			republican_tradition = -30
		}
		add_war_exhaustion = 5
		add_stability = -2
		add_country_modifier = {
			name = wallachian_terror_decapitated_monarchy
			duration = 3650
		}
	}
}

#Humiliation Event - Impaled Country
country_event = {
	id = wallachian_terror_events.8
	title = wallachian_terror_events.8.t
	desc = wallachian_terror_events.8.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	option = {
		name = wallachian_terror_events_impaled_country_humiliated
		add_prestige = -20
		add_legitimacy_equivalent = {
			amount = -20
			republican_tradition = -10
		}
		if = {
			limit = {
				event_target:impaler_country = {
					is_rival = PREV
				}
			}
			add_power_projection = {
				type = humiliated_by_rival
				amount = -30
			}
		}
		else = {
			add_power_projection = {
				type = wallachian_terror_ruler_humiliated
				amount = -15
			}
		}
		add_country_modifier = {
			name = wallachian_terror_humiliated_ruler
			duration = 3650
		}
		every_subject_country = {
			add_liberty_desire = 15
		}
		add_opinion = {
			who = event_target:impaler_country
			modifier = wallachian_terror_humiliated_us_opinion
		}
	}
}

#Emperor failed the empire event.
country_event = {
	id = wallachian_terror_events.9
	title = wallachian_terror_events.9.t
	desc = wallachian_terror_events.9.d
	picture = AB_LOTHAIR_eventPicture
	is_triggered_only = yes
	major = yes
	option = {
		name = wallachian_terror_emperor_failed_to_protect_prince
		wallachian_terror_hre_emperor_failed_to_protect_effect = yes
	}
}

#Banked Impaler Trait Event
country_event = {
	id = wallachian_terror_events.10
	title = wallachian_terror_events.10.t
	desc = wallachian_terror_events.10.d
	picture = GFX_wallachian_terror_events.10
	trigger = {
		has_government_mechanic = wallachian_terror_mechanic
		NOT = {
			OR = {
				has_heir_flag = impaler_heir
				has_heir_flag = not_impaler_heir
			}
		}
		heir_age = 10
		check_variable = {
			which = impaler_ruler_count
			value = 1
		}
	}
	mean_time_to_happen = {
		days = 1
	}
	immediate = {
		#For the banked traits tooltip
		hidden_effect = {
			set_variable = {
				which = impaler_ruler_count_after
				which = impaler_ruler_count
			}
			subtract_variable = {
				which = impaler_ruler_count_after
				value = 1
			}
		}
	}
	option = {
		name = wallachian_terror_events.10.a
		trigger = {
			NOT = {
				ruler_has_personality = impaler_personality
			}
		}
		custom_tooltip = awaken_the_butcher_impaler_personality_heir_tooltip
		custom_tooltip = wallachian_terror_events_come_of_age_tooltip
		custom_tooltip = wallachian_terror_events.10_banked_traits_tooltip
		hidden_effect = {
			set_heir_flag = impaler_heir
			subtract_variable = {
				which = impaler_ruler_count
				value = 1
			}
		}
	}
	option = {
		name = wallachian_terror_events.10.b
		highlight = yes
		trigger = {
			ruler_has_personality = impaler_personality
		}
		custom_tooltip = awaken_the_butcher_impaler_personality_heir_tooltip
		custom_tooltip = wallachian_terror_events_come_of_age_tooltip
		custom_tooltip = wallachian_terror_events.10_banked_traits_tooltip
		hidden_effect = {
			set_heir_flag = impaler_heir
			subtract_variable = {
				which = impaler_ruler_count
				value = 1
			}
		}
		custom_tooltip = wallachian_terror_events.10_loving_parent_tooltip
		change_heir_stat = {
			type = dip
			amount = 1
		}
	}
	option = {
		name = wallachian_terror_events.10.c
		random_list = {
			50 = {
				custom_tooltip = wallachian_terror_events.10_zealot_heir_tooltip
				tooltip = {
					add_heir_personality = zealot_personality
				}
				custom_tooltip = wallachian_terror_events_come_of_age_tooltip
				hidden_effect = {
					set_heir_flag = zealot_heir
				}
			}
			50 = {
			}
		}
		custom_tooltip = wallachian_terror_events.10_heir_not_gain_trait_tooltip
		custom_tooltip = wallachian_terror_events.10_banked_traits_tooltip
		hidden_effect = {
			set_heir_flag = not_impaler_heir
			subtract_variable = {
				which = impaler_ruler_count
				value = 1
			}
		}
	}
}
