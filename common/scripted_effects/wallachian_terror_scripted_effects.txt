enable_terror_gain_from_battles = {
	set_country_flag = wallachian_terror_gain_terror_from_dead_enemies
}

disable_terror_gain_from_battles = {
	clr_country_flag = wallachian_terror_gain_terror_from_dead_enemies
}

#ROOT = location of battle
#FROM = winner country
apply_wallachian_terror_battle_won_enemy_province_modifier = {
	if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 0
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 25
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_garden_of_the_defeated
			duration = 182
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 25
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 50
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_garden_of_the_defeated
			duration = 365
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 50
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 75
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_garden_of_the_defeated
			duration = 547
		}
	}
	else = {
		add_province_modifier = {
			name = wallachian_terror_garden_of_the_defeated
			duration = 730
		}
	}
}

#ROOT = location of battle
#FROM = winner country
apply_wallachian_terror_battle_won_own_province_modifier = {
	if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 0
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 25
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_warning_for_the_rest
			duration = 182
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 25
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 50
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_warning_for_the_rest
			duration = 365
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 50
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 75
					}
				}
			}
		}
		add_province_modifier = {
			name = wallachian_terror_warning_for_the_rest
			duration = 547
		}
	}
	else = {
		add_province_modifier = {
			name = wallachian_terror_warning_for_the_rest
			duration = 730
		}
	}
}

apply_wallachian_terror_battle_won_owner_penalty = {
	if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 0
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 25
					}
				}
			}
		}
		owner = {
			add_war_exhaustion = 0.25
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 25
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 50
					}
				}
			}
		}
		owner = {
			add_war_exhaustion = 0.5
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 50
				}
				NOT = {
					has_government_power = {
						mechanic_type = wallachian_terror_mechanic
						power_type = terror_power
						value = 75
					}
				}
			}
		}
		owner = {
			add_war_exhaustion = 0.75
		}
	}
	else_if = {
		limit = {
			FROM = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 75
				}
			}
		}
		owner = {
			add_war_exhaustion = 1
		}
	}
}

change_terror = {
	add_government_power = {
		mechanic_type = wallachian_terror_mechanic
		power_type = terror_power
		value = $value$
		scaled_with_gain_modifier = $scaled_with_gain_modifier$
	}
	if = {
		limit = {
			is_wallachian_terror_dynamic_country_color_enabled = yes
		}
		change_color_based_on_terror = yes
	}
}

change_terror_var = {
	variable_government_power_effect = {
		var = $var$
		mechanic_type = wallachian_terror_mechanic
		power_type = terror_power
		scaled_with_gain_modifier = $scaled_with_gain_modifier$
	}
	if = {
		limit = {
			is_wallachian_terror_dynamic_country_color_enabled = yes
		}
		change_color_based_on_terror = yes
	}
}

change_color_based_on_terror = {
	if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 0
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 10
				}
			}
		}
		change_country_color = {
			color = {
				68
				122
				174
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 10
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 20
				}
			}
		}
		change_country_color = {
			color = {
				73
				110
				159
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 20
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 30
				}
			}
		}
		change_country_color = {
			color = {
				78
				98
				143
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 30
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 40
				}
			}
		}
		change_country_color = {
			color = {
				83
				86
				128
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 40
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 50
				}
			}
		}
		change_country_color = {
			color = {
				88
				73
				113
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 50
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 60
				}
			}
		}
		change_country_color = {
			color = {
				93
				61
				98
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 60
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 70
				}
			}
		}
		change_country_color = {
			color = {
				98
				49
				83
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 70
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 80
				}
			}
		}
		change_country_color = {
			color = {
				104
				37
				67
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 80
			}
			NOT = {
				has_government_power = {
					mechanic_type = wallachian_terror_mechanic
					power_type = terror_power
					value = 90
				}
			}
		}
		change_country_color = {
			color = {
				110
				24
				52
			}
		}
	}
	else_if = {
		limit = {
			has_government_power = {
				mechanic_type = wallachian_terror_mechanic
				power_type = terror_power
				value = 90
			}
		}
		change_country_color = {
			color = {
				120
				0
				0
			}
		}
	}
}

wallachian_terror_on_raze_effect = {
	if = {
		limit = {
			owner = {
				has_government_mechanic = wallachian_terror_mechanic
				has_country_modifier = wallachian_terror_brutalize_the_enemy
			}
		}
		add_province_modifier = {
			name = wallachian_terror_raze_mod
			duration = 5475
		}
		add_nationalism = 15
		export_to_variable = {
			which = dev
			value = development
		}
		divide_variable = {
			which = dev
			value = 40
		}
		owner = {
			set_variable = {
				which = dev
				which = PREV
			}
			change_terror_var = {
				var = dev
				scaled_with_gain_modifier = yes
			}
		}
	}
}
